--// Services
local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local Mouse = Player:GetMouse()
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

print("DEBUG: LocalScript Loaded")

--// Inventory
local LocalInventory = {}

--// Correct Pet Folder in Workspace
local PetFolder = Workspace:WaitForChild("LocalPets")
print("DEBUG: PetFolder located at:", PetFolder:GetFullName())

--// GUI Setup
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "PetSpawnerGui"
ScreenGui.Parent = Player:WaitForChild("PlayerGui")

print("DEBUG: GUI Initialized")

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 300, 0, 180)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -90)
MainFrame.BackgroundColor3 = Color3.fromRGB(255, 150, 200)
MainFrame.BorderSizePixel = 0
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
MainFrame.Parent = ScreenGui

local UIGradient = Instance.new("UIGradient")
UIGradient.Color = ColorSequence.new({
	ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 180, 220)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 140, 210))
})
UIGradient.Rotation = 90
UIGradient.Parent = MainFrame

local Stroke = Instance.new("UIStroke")
Stroke.Thickness = 3
Stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
Stroke.Color = Color3.fromRGB(255, 0, 200)
Stroke.Parent = MainFrame

local neonColors = {
	Color3.fromRGB(255, 0, 200),
	Color3.fromRGB(0, 220, 255),
	Color3.fromRGB(180, 0, 255),
	Color3.fromRGB(255, 120, 0),
}

task.spawn(function()
	while true do
		for _, neonColor in ipairs(neonColors) do
			local tween = TweenService:Create(Stroke, TweenInfo.new(1.5, Enum.EasingStyle.Linear), {Color = neonColor})
			tween:Play()
			tween.Completed:Wait()
		end
	end
end)

Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 10)

local TitleFrame = Instance.new("Frame")
TitleFrame.Size = UDim2.new(1, -20, 0, 35)
TitleFrame.Position = UDim2.new(0, 10, 0, 5)
TitleFrame.BackgroundColor3 = Color3.fromRGB(0,0,0)
TitleFrame.BackgroundTransparency = 0.1
TitleFrame.BorderSizePixel = 0
TitleFrame.Parent = MainFrame
Instance.new("UICorner", TitleFrame).CornerRadius = UDim.new(0,8)

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1,0,1,0)
Title.BackgroundTransparency = 1
Title.Text = "amina pets nyo"
Title.TextColor3 = Color3.fromRGB(255,255,255)
Title.Font = Enum.Font.SourceSansBold
Title.TextSize = 20
Title.Parent = TitleFrame

local PetNameBox = Instance.new("TextBox")
PetNameBox.Size = UDim2.new(0.9,0,0,30)
PetNameBox.Position = UDim2.new(0.05,0,0,50)
PetNameBox.PlaceholderText = "Enter Pet Name"
PetNameBox.BackgroundColor3 = Color3.fromRGB(60,60,60)
PetNameBox.TextColor3 = Color3.fromRGB(255,255,255)
PetNameBox.Font = Enum.Font.SourceSans
PetNameBox.TextSize = 18
PetNameBox.ClearTextOnFocus = false
PetNameBox.Parent = MainFrame
Instance.new("UICorner", PetNameBox).CornerRadius = UDim.new(0,5)

local function CreateButton(name,color,posX)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(0.25,0,0,30)
	btn.Position = UDim2.new(posX,0,0,90)
	btn.BackgroundColor3 = color
	btn.Text = name
	btn.TextColor3 = Color3.fromRGB(255,255,255)
	btn.Font = Enum.Font.SourceSansBold
	btn.TextSize = 18
	btn.Parent = MainFrame
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0,5)
	return btn
end

local MFRBtn = CreateButton("MFR", Color3.fromRGB(255,100,100), 0.05)
local NFRBtn = CreateButton("NFR", Color3.fromRGB(100,255,100), 0.375)
local FRBtn = CreateButton("FR", Color3.fromRGB(100,100,255), 0.7)

local selectedRarity = "MFR"

local function selectRarity(rarity)
	print("DEBUG: Selected rarity:", rarity)
	selectedRarity = rarity
end

MFRBtn.MouseButton1Click:Connect(function() selectRarity("MFR") end)
NFRBtn.MouseButton1Click:Connect(function() selectRarity("NFR") end)
FRBtn.MouseButton1Click:Connect(function() selectRarity("FR") end)

--// -------- FINAL FIXED PET SPAWNER --------
local function findPetModel(petName)
	print("DEBUG: Searching LocalPets for:", petName)
	local pet = PetFolder:FindFirstChild(petName)

	if pet then
		print("DEBUG: PET FOUND:", pet:GetFullName())
	else
		print("DEBUG: Pet not found inside LocalPets.")
	end

	return pet
end

SpawnBtn.MouseButton1Click = nil -- clear old connection
SpawnBtn.MouseButton1Click:Connect(function()
	local petName = PetNameBox.Text

	if petName == "" then
		warn("DEBUG: No name typed.")
		return
	end

	print("DEBUG: Spawn button clicked:", petName)

	local petTemplate = findPetModel(petName)
	if not petTemplate then
		warn("FINAL RESULT: Pet not found:", petName)
		return
	end

	local char = Player.Character or Player.CharacterAdded:Wait()
	local hrp = char:WaitForChild("HumanoidRootPart")

	local clone = petTemplate:Clone()
	clone.Parent = PetFolder

	if clone.PrimaryPart then
		clone:SetPrimaryPartCFrame(hrp.CFrame * CFrame.new(3,0,0))
	end

	table.insert(LocalInventory, {Name = petName, Rarity = selectedRarity, Model = clone})
	print("DEBUG: Pet spawned successfully.")
end)

RunService.RenderStepped:Connect(function()
	local char = Player.Character
	if not char then return end

	local root = char:FindFirstChild("HumanoidRootPart")
	if not root then return end

	for _,data in ipairs(LocalInventory) do
		local model = data.Model
		if model and model.PrimaryPart then
			local targetPos = root.Position + Vector3.new(3,0,0)
			local newPos = model.PrimaryPart.Position:Lerp(targetPos,0.1)
			model:SetPrimaryPartCFrame(CFrame.new(newPos))
		end
	end
end)
