-- Pet Spawner GUI (Owl Pet Example)
print("[PetSpawnerUI] Script started")

local player = game.Players.LocalPlayer
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local HttpService = game:GetService("HttpService")

-- === GUI Setup ===
local gui = Instance.new("ScreenGui")
gui.Name = "PetSpawnerUI"
gui.ResetOnSpawn = false
gui.IgnoreGuiInset = true
gui.Parent = player:WaitForChild("PlayerGui")

-- Main Frame
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 350, 0, 270)
frame.Position = UDim2.new(0.5, -175, 0.25, 0)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
frame.BorderSizePixel = 0
frame.Active = true
frame.ClipsDescendants = false
frame.Parent = gui
Instance.new("UICorner", frame)

-- Title
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -20, 0, 40)
title.Position = UDim2.new(0, 10, 0, 0)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextScaled = true
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Text = "Pet Spawner By Shxdrag"
title.Parent = frame

-- Pet Name Box
local petName = Instance.new("TextBox")
petName.Size = UDim2.new(1, -20, 0, 40)
petName.Position = UDim2.new(0, 10, 0, 50)
petName.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
petName.BorderSizePixel = 0
petName.Font = Enum.Font.GothamBold
petName.TextScaled = true
petName.TextColor3 = Color3.fromRGB(255, 255, 255)
petName.PlaceholderText = "Enter Pet Name (e.g. Owl)"
petName.ClearTextOnFocus = false
petName.Parent = frame
Instance.new("UICorner", petName)

-- Rarity Buttons
local rarityFrame = Instance.new("Frame")
rarityFrame.Size = UDim2.new(1, 0, 0, 50)
rarityFrame.Position = UDim2.new(0, 0, 0, 100)
rarityFrame.BackgroundTransparency = 1
rarityFrame.Parent = frame

local uiList = Instance.new("UIListLayout")
uiList.FillDirection = Enum.FillDirection.Horizontal
uiList.HorizontalAlignment = Enum.HorizontalAlignment.Center
uiList.Padding = UDim.new(0, 10)
uiList.Parent = rarityFrame

local selectedRarity = "MFR" -- Default

local function createRarityButton(name, color)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(0, 90, 1, -5)
	btn.BackgroundColor3 = color
	btn.BorderSizePixel = 0
	btn.TextColor3 = Color3.fromRGB(255, 255, 255)
	btn.Font = Enum.Font.GothamBold
	btn.TextScaled = true
	btn.Text = name
	btn.Parent = rarityFrame
	Instance.new("UICorner", btn)

	btn.MouseButton1Click:Connect(function()
		selectedRarity = name
		print("[PetSpawnerUI] Selected rarity:", name)
	end)
end

createRarityButton("MFR", Color3.fromRGB(255, 100, 100))
createRarityButton("NFR", Color3.fromRGB(100, 255, 100))
createRarityButton("FR", Color3.fromRGB(100, 100, 255))

-- Spawn Button
local spawnBtn = Instance.new("TextButton")
spawnBtn.Size = UDim2.new(1, -20, 0, 45)
spawnBtn.Position = UDim2.new(0, 10, 0, 170)
spawnBtn.BackgroundColor3 = Color3.fromRGB(70, 120, 255)
spawnBtn.BorderSizePixel = 0
spawnBtn.Font = Enum.Font.GothamBold
spawnBtn.TextScaled = true
spawnBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
spawnBtn.Text = "Spawn Pet"
spawnBtn.Parent = frame
Instance.new("UICorner", spawnBtn)

-- Status Label
local statusLabel = Instance.new("TextLabel")
statusLabel.Size = UDim2.new(1, -20, 0, 30)
statusLabel.Position = UDim2.new(0, 10, 0, 225)
statusLabel.BackgroundTransparency = 1
statusLabel.Font = Enum.Font.GothamBold
statusLabel.TextScaled = true
statusLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
statusLabel.Text = "No pet spawned yet"
statusLabel.Parent = frame

-- Dummy Image for testing
local dummyImageId = "rbxassetid://6023426910"

-- Require ClientData safely
local clientData
local ok, err = pcall(function()
	clientData = require(ReplicatedStorage.ClientModules.Core.ClientData)
end)
if not ok then
	warn("[PetSpawnerUI] Failed to load ClientData:", err)
end

local data
if clientData then
	local success, d = pcall(function()
		return clientData.get_data()[tostring(player)]
	end)
	if success then
		data = d
	else
		warn("[PetSpawnerUI] Failed to get player data:", d)
	end
end

-- Spawn Function
spawnBtn.MouseButton1Click:Connect(function()
	local petTemplate = petName.Text
	if not petTemplate or petTemplate == "" then
		warn("[PetSpawnerUI] No pet name entered!")
		return
	end

	if not data or not data.inventory then
		warn("[PetSpawnerUI] Player data not loaded or invalid")
		return
	end

	local newPet = {
		id = HttpService:GenerateGUID(false),
		uid = HttpService:GenerateGUID(false),
		template = petTemplate,
		category = "PETS",
		icon = dummyImageId,
		thumbnail = dummyImageId,
		rarity = selectedRarity,
		properties = {
			rideable = true,
			flyable = true,
			neon = false,
			mega = false,
			age = 0,
			level = 1,
			unique = false,
			placeId = 0,
		},
		data = {
			category = "PETS"
		}
	}

	table.insert(data.inventory.pets, newPet)
	data.equippedPet = newPet
	print("[PetSpawnerUI] Spawned and auto-equipped pet:", petTemplate, selectedRarity)

	statusLabel.Text = "Spawned & Equipped: "..petTemplate.." ("..selectedRarity..")"
	statusLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
end)
